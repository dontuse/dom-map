<!DOCTYPE html>
<!--[if lt IE 7]>
<html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">

    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/main.css">
    <script src="js/vendor/modernizr-2.6.2.min.js"></script>
</head>
<body>
<!--[if lt IE 7]>
<p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade
    your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to
    improve your experience.</p>
<![endif]-->

<!-- Add your site or application content here -->


<div class="wrapper">

   <div style="overflow: hidden; margin-bottom: 15px;">
       <img style="float: left; margin-right: 10px" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAGBQTFRF6hoi9NDR6xAZ7IeL/P//7Ssz6G5z9+bm5lBX8bi66l9l7KGl8qaq5TM75iIs+e7u5TtE8rW3+fTz636D7Jib7quu7BUe8bCy+/r587y++fb35kRL9tzc88bI////7RskOKXOAwAAA9ZJREFUeNrt2IlyozgQBuBW0xJYBBlztMFA8/5vubQILk8yiafWoWprh79S4tYXCXEZSrt7SrDz7rEHciAHciAHciAH8p9HQPPjCMQCGDWsS2Get0X+qZZofRCKzNXNtZ9MzNRf88RlZdCt/CoCgCGrryatSGJI/0jW3FJzSbxFfhVJRhKiLp3aJqmdf4+r66adxk7NtAnwEoKOyLSJGyzgp4AdfNIaogRfQ3LpQzzjv+sSZrUauryIvMkX/yboOdfRjF563gPRYOGzwDPsiaBPhaaS90S4SIlEWtyzu9CLZgy8J5LFS9IA7IgAnBaDatx1dHHIR+N45yHMHALDrogGFmJnRHMgB3IgB/I3I5QjMgN8db9HrOmEryEJdW++DMCo1kNQA6H0zZma1xC2JxLpUnNqap+VhbU2hKUoyszXzcWknRCZgl9AVJmz+jJ2EkPVOY05V+saovSS6CveawgAIofBu6S5TqPWfuu62zkdzSVPnB8sIzK8hiizvVgzBFuUMYUNsK7jH/9mBL4H4PjE/p8hjGt4W7yPUeT7Lr/uz1pALHR4IPITBEq/ZphBD7CZc1lgXfAZr9WWzsJ9/8K5ggfnAxfOW57BelfyE+QkMZQWvBguJSGaBpy5qKp4MAdDGd4b0pJck44o5xPpXQwboh6eIJOY9tr2cl4QrInG/FpJWjLbs+RaN2b0iPRCCyEyhmn98srjZ8szpEbGgRaEy4paiziM1CtCCgP0vyDachrH0fFE8rYikxrPEMBBW4KNmIDxuXQrcUFid3iSR+QiknoIAWGSDTF/hHBEwKzPRQ6juAXpblWBfKHqA9IjA8C/Q9Cm5GJteJUGbZXmlKAnM8lHRCv9cwSCkaXiDZGIQESKKs3OabiK7yMCS94Rnu8IYE7PELYp+a0lQbtLK4qyrc6hkbYyoC0BQGD+hOgQlqdIUVGmCG0nPn57drdBEbtslRojMidmyvADYgIW5tkQZu1yQERFEMtK3sIyGamHhV9WXcUEUESvFhkD82lDtJ/IXFJ5MoTZN0bGZklLt7axmJCYJj9LOvCKDJNDMIp4EqmKRyQjESK6EZmvEZixlRiiWGaIdaqzRvvFdlonMESEi1EkZ9BDrrgen1Qi1OrFyF8i8YUxd1tGyRiwcMn7+wg4t3Y1ZLWFmYvaBdZJvd0PeagTz6FOhieIxy0TZbze6iOxbMWl1DBCLJG3yeMvr3HF94jDdVYvYEU+5+ufn9/Xa/kd0nQe7/f82/B75MPM583fI2yHAO/7cjHMsMvjF/hhHmGG423lQA7kQA7kQP4ypLS7p/wHEP4cE/iw8uwAAAAASUVORK5CYII=" width="100" height="100">
       <h1>Веб камеры в Eкатеренбуге</h1>
   </div>

    <div class="b-ya-video-map">
        <div id="map" style="height: 500px"></div>
        <div class="b-ya-video-map__points-box">
            <span class="b-ya-video-map__points-box">адреса расположения веб камер:</span>
            <span>
                <a class="b-ya-video-map__p-l" href="">точка 1</a> <a class="b-ya-video-map__p-l" href="">точка 3</a>
            <a class="b-ya-video-map__p-l" href="">точка 4</a> <a class="b-ya-video-map__p-l" href="">точка 5</a>
            <a href="">точка 5</a>
            </span>
        </div>
    </div>

</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="js/plugins.js"></script>
<script src="js/main.js"></script>
<script src="http://api-maps.yandex.ru/2.0-stable/?load=package.standard&lang=ru-RU" type="text/javascript"></script>


<!-- -->
<script id="ya-map-tpl" type="tpl">
    <div style="padding: 15px;">
        <img width="320" height="240" src="$[properties.url]">
    </div>
</script>
<!-- -->

<!-- данные для карты-->
<script>
    var yaVideoPointData = [
        {
            "id": 1,
            address: "Ул Московская 225",
            "type": "office",
            "name": "Банк «Екатеринбург» ОАО, Юго-Западное ОПЕРУ",
            "phones": "311–05–66, 311–05–67",
            "lat": "60.600448",
            "lon": "56.83615",
            "url": "http://cctv.ekat.ertelecom.ru:8080/mobile?login=ertel_07&password=43a53593349ea0ec9e66e046558fcd12&channelid=3f8fe25f-9708-4040-a74f-f2e4abd43214&camera_fps=0"
        },
        {
            "id": 11,
            address: "Парк Культуры",
            "type": "office",
            "name": "Банк «Екатеринбург» ОАО, Юго-Западное ОПЕРУ",
            "phones": "311–05–66, 311–05–67",
            "lat": "60.627178",
            "lon": "56.828436",
            "url": "http://cctv.ekat.ertelecom.ru:8080/mobile?login=ertel_q7&password=1a52b9fb1587502bae8709d5345a29ae&channelid=6020ac3e-c228-492f-8a5d-d73ab3cf42ba&camera_fps=0"
        },
        {
            "id": 133,
            address: "Ул Тверская 25/3",
            "type": "office",
            "name": "Банк «Екатеринбург» ОАО, Юго-Западное ОПЕРУ",
            "phones": "311–05–66, 311–05–67",
            "lat": "60.58290518252431",
            "lon": "56.836598198318306",
            "url": "http://cctv.ekat.ertelecom.ru:8080/mobile?login=ertel_07&password=43a53593349ea0ec9e66e046558fcd12&channelid=c49daca8-2f38-4dc7-ae18-232f8e166a71&camera_fps=0"
        },
        {
            "id": 134,
            address: "Уличная Улица 225",
            "type": "office",
            "name": "Банк «Екатеринбург» ОАО, Юго-Западное ОПЕРУ",
            "phones": "311–05–66, 311–05–67",
            "lat": "60.58290518252431",
            "lon": "56.836598198318306",
            "url": "http://cctv.ekat.ertelecom.ru:8080/mobile?login=ertel_07&password=43a53593349ea0ec9e66e046558fcd12&channelid=c49daca8-2f38-4dc7-ae18-232f8e166a71&camera_fps=0"
        }
    ];
</script>

<script>
    $(function () {
        ymaps.ready(init);
        var map;
        var data = yaVideoPointData;


        function init() {

            var BallonTpl = $('#ya-map-tpl').html();

            var map = new ymaps.Map("map", {
                center: [56.326944, 44.0075],
                zoom: 10,
                type: 'yandex#map'
            });

            map.controls
                    .add('zoomControl');

            var myCollection = new ymaps.GeoObjectCollection();

            console.log(myCollection);

            renderPoints(data);


            function renderPoints(json) {

                var html = '';

                if (json.length === 0) {
                    return;
                }


                myCollection.removeAll();

                for (var i = 0; i < json.length; i++) {

                    html += '<a data-id="' + json[i].id + '" class="js-ya-video-map__points-box__a" href="">' + json[i].address + '</a>';

                    var BallLayout = ymaps.templateLayoutFactory.createClass(BallonTpl);

                    var placemark = new ymaps.Placemark([json[i].lon, json[i].lat], {
                        name: json[i].name,
                        address: json[i].address,
                        id: json[i].id,
                        url: json[i].url

                    }, {
                        balloonZIndex: 1111,
                        balloonContentLayout: BallLayout,
                        pointSelected: false
                    });


                    // добавляем метки в коллекцию
                    myCollection.add(placemark);

                }

                $('#js-ya-video-map__points-box').html(html);

                $('.js-ya-video-map__points-box__a').click(function (e) {
                    e.preventDefault();
                    var id = $(this).data('id');
                    alert(id);
                    go_to(id);
                });

                map.geoObjects.add(myCollection);
                // Set center and zoom using collection bounds.
                map.setBounds(myCollection.getBounds(), {checkZoomRange: true});

            }

            function go_to(id) {

                //lat,lon,address
                // map.setCenter([56.796028, 60.581098], 16);

                myCollection.each(function (point) {

                    var idProp = parseInt(point.properties.get('id'), 10);
                    point.options.set('pointSelected', false);

                    if (id === idProp) {

                        //центрируем карту на точку
                        point.options.set('balloonAutoPan', false);
                        // point.options.set('iconImageHref', 'imgs/ya-maps/point.png');
                        //point.options.set('pointSelected', true);

                        point.balloon.open();
                        map.setBounds(point.geometry.getBounds(),
                                {
                                    checkZoomRange: true,
                                    callback: function () {
                                        point.balloon.open();
                                        point.options.set('balloonAutoPan', true);
                                    }
                                });

                    }
                });

                return false;
            }


        }


    });
</script>


<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
    var _gaq = [
        ['_setAccount', 'UA-XXXXX-X'],
        ['_trackPageview']
    ];
    (function (d, t) {
        var g = d.createElement(t), s = d.getElementsByTagName(t)[0];
        g.src = '//www.google-analytics.com/ga.js';
        s.parentNode.insertBefore(g, s)
    }(document, 'script'));
</script>
</body>
</html>
